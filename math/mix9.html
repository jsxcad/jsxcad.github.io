<html>
 <head>
  <style>
  {
    font-size: 1em;
  }
  </style>
 </head>
 <body>
  <script type='module'>
   import * as m from './mix.js';
   const { body } = document;

   const buildAlgebraProblem = (chosen) => {
     const problem = () => m.choose([
       // { value: m.buildDistanceTimeProblem, weight: 5 },
       // { value: m.buildTimeDistanceProblem, weight: 5 },
       // { value: m.buildTimeMeetProblem, weight: 5 },
       // { value: m.buildWorkTogetherTimeProblem, weight: 5 },
       // { value: m.buildWorkApartTimeProblem, weight: 5 },
       // { value: m.buildAttendanceCountProblem, weight: 5 },
       { value: m.buildLeverWeightProblem, weight: 5 },
       { value: m.buildLeverDistanceProblem, weight: 5 },
       // { value: m.buildAgeProblem, weight: 5 },
       // { value: m.buildProportionProblem, weight: 5 },
       { value: m.buildPerimeterDimensionsProblem, weight: 5 },
       // { value: m.buildAngleProblem, weight: 5 },
       { value: m.buildPerimeterSideProblem, weight: 5 },
       // { value: m.buildCutProblem, weight: 5 },
       // This isn't algebra, but it is similarly expensive.
       // { value: m.buildSimpleDivision32, weight: 5 },
     ], chosen)(chosen);
     return `<table style="border: solid; width: 100%; height: 315"><tr style="outline: thin dotted"><td style="vertical-align: top">${problem()}</td></tr></table>`;
   }

   const buildMathProblem = (chosen) => {
     const problems = [];
     for (let i = 0; i < 4; i++) {
       problems.push(
         m.choose([
           { value: m.buildSimpleDivision31, weight: 100 },
           // { value: m.buildSimpleDivision32, weight: 100 },
           { value: m.buildAddition, weight: 5 },
           { value: m.buildMultiplication21, weight: 5 },
           { value: m.buildMultiplication22, weight: 5 },
           { value: m.buildMultiplicationTens, weight: 1 },
           { value: m.buildMultiplicationThousands, weight: 1 },
           { value: m.buildMultiplicationOneOffTens, weight: 5 },
           { value: m.buildMultiplicationOneOffHundreds, weight: 5 },
           // { value: m.buildMultiplicationInequality, weight: 50 },
           { value: m.buildMultiplicationInequalitySimple, weight: 50 },
           { value: m.buildRationalAddition, weight: 50 },
           { value: m.buildRationalSubtraction, weight: 50 },
           { value: m.buildDecimalDecimalSubtraction, weight: 5 },
           { value: m.buildIntegerRationalSubtraction, weight: 5 },
           { value: m.buildIntegerDecimalSubtraction, weight: 5 },
           { value: m.buildIntegerDecimalMultiplication, weight: 5 },
           { value: m.buildIntegerPercentageMultiplication, weight: 5 },
           { value: m.buildIntegerRationalMultiplication, weight: 5 },
           { value: m.buildIntegerRationalDivision, weight: 50 },
           { value: m.buildRationalMultiplication, weight: 5 },
           { value: m.buildRationalDivision, weight: 50 },
           { value: m.buildSubtraction, weight: 5 },
           { value: m.buildTimeAddition, weight: 5 },
           { value: m.buildTimeSubtraction, weight: 5 },
           { value: m.buildSquare, weight: 5 },
           { value: m.buildCube, weight: 5 },
           { value: m.buildSquareRoot, weight: 5 },
           { value: m.buildUnitAddition, weight: 1 },
           { value: m.buildUnitSubtraction, weight: 1 },
           { value: m.buildUnitMultiplication, weight: 1 },
           { value: m.buildUnitDivision, weight: 1 },
           { value: m.buildUnitDimensionlessDivision, weight: 1 },
           { value: m.buildUnitDimensionlessMultiplication, weight: 1 },
           { value: m.buildSameUnitAddition, weight: 1 },
           { value: m.buildSameUnitNegativeAddition, weight: 1 },
           { value: m.buildSameUnitSubtraction, weight: 1 },
           { value: m.buildSameUnitMultiplication, weight: 5 },
           { value: m.buildSameUnitDivision, weight: 5 },
           { value: m.buildConvertibleUnitAddition, weight: 5 },
           { value: m.buildConvertibleUnitNegativeAddition, weight: 5 },
           { value: m.buildConvertibleUnitSubtraction, weight: 5 },
           { value: m.buildConvertibleUnitMultiplication, weight: 5 },
           { value: m.buildConvertibleUnitDivision, weight: 50 },
           { value: m.buildSystemOfEquations, weight: 1000, limit: 5 },
           { value: m.buildSameBasisAddition, weight: 1 },
           { value: m.buildRationalInequality, weight: 100 },
         ], chosen)(chosen));
      }
      const rows = [];
      for (const problem of problems) {
        rows.push(`<tr style="outline: thin dotted; height: 76px"><td style="vertical-align: middle">${problem}</td></tr>`);
      }
      return `<table style="border: solid; width: 100%">${rows.join('\n')}</table>`;
   }

   const buildStoryProblem = (count, chosen, promptWeight = 200, emotivePromptWeight = 10) => {
     const vocab = [];
     for (let i = 0; i < count; i++) {
       const choice = m.choose([
         { value: m.buildPromptWord, weight: promptWeight, limit: Infinity },
         { value: m.buildEmotivePromptWord, weight: emotivePromptWeight, limit: Infinity },
       ], chosen);
       vocab.push(choice(chosen));
     }
     const rows = [];
     rows.push(`<tr style="height: 29.25px; outline: thin solid; margin: 10px"><td style="text-align: right">${vocab.join(', ')}</td></tr>`);
     for (let j = 1; j < 10; j++) {
       rows.push(`<tr style="height: 29.25px; outline: thin dotted; margin: 10px"><td></td></tr>`);
     }
     return `<table style="border: solid; width: 100%">${rows.join('\n')}</table>`;
   }

   const buildSpellingProblem = (chosen) => {
     const problems = [];
     for (let i = 0; i < 6; i++) {
       problems.push(
         m.choose([
           { value: m.buildSpellingQuestion, weight: 200, limit: Infinity },
         ], chosen)(chosen)
       );
     }
     const rows = [];
     for (const problem of problems) {
       rows.push(`<tr style="outline: thin dotted; height: 76px"><td>${problem}</td></tr>`);
     }
     return rows.join('\n');
   };

   const buildProblem = (chosen) => {
     const problem = m.choose([
         { value: buildAlgebraProblem, limit: 1},
         { value: buildMathProblem, limit: 1 },
         // { value: buildStoryProblem, limit: 0 },
         // { value: buildSpellingProblem, limit: 0 },
       ], chosen);
     return `<table style="border: solid; width: 100%">${problem(chosen)}</table>`;
   }

   const t = document.createElement('table');
   const chosen = new Map();
   body.innerHTML = `
     <table style="width: 100%">
       <tr>
        <td style="width: 50%">
         ${buildAlgebraProblem(chosen)}
         ${buildAlgebraProblem(chosen)}
         ${buildMathProblem(chosen)}
        </td>
        <td style="width: 50%">
         ${buildStoryProblem(5, chosen, 200, 10)}
         ${buildStoryProblem(2, chosen, 100, 50)}
         ${buildStoryProblem(2, chosen, 50, 100)}
        </td>
       </tr>
     </table>
   `;
  </script>
 </body>
</html>
